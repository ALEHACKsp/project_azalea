# SConstruct file for object-mgr-test

import os
import defaults

# Setup Environment.
env = Environment()
defaults.setup_default_env(env)

env['CXXFLAGS'] = '-std=gnu++14'
env['LINKFLAGS'] = '-Wl,--start-group'

# List of required components.
dependencies_in = ['#test/test_core/SConscript',
                   '#test/object_mgr/SConscript',
                   '#klib/misc/SConscript',
                   '#klib/synch/SConscript',
                   '#klib/data_structures/Sconscript',
                   '#test/dummy_libs/_tracing/SConscript',
                   '#test/dummy_libs/panic/SConscript',
                   '#object_mgr/SConscript',
                  ]
                   
# Build components.
dependencies_out = [ ]

for dep in dependencies_in:
  out_dir = os.path.join('output', dep.strip('#'))
  dep_out = SConscript(dep, 'env', variant_dir=out_dir, duplicate=0)
  dependencies_out.append(dep_out)

env.Program("output/object-mgr-test", dependencies_out)